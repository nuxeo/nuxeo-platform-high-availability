<?xml version="1.0" encoding="UTF-8"?>
<component name="org.nuxeo.ecm.platform.queue.nx.persister.contrib">

  <extension target="org.nuxeo.ecm.core.schema.TypeService" point="doctype">
    <doctype name="QueueRoot" extends="Folder">
      <schema name="common" />
      <schema name="dublincore" />
      <facet name="HiddenInNavigation" />
    </doctype>

    <doctype name="Queue" extends="Folder">
      <schema name="common" />
      <schema name="dublincore" />
    </doctype>

    <doctype name="QueueItem" extends="Document">
      <schema name="common" />
      <schema name="dublincore" />
      <schema name="queueitem" />
    </doctype>
  </extension>

  <extension target="org.nuxeo.ecm.core.schema.TypeService" point="schema">
    <schema name="queueitem" prefix="qitm"  src="schemas/queueitem.xsd" />
  </extension>

  <extension target="org.nuxeo.ecm.core.api.DocumentAdapterService"
    point="adapters">
    <adapter class="org.nuxeo.ecm.platform.queue.api.QueueInfo"
      factory="org.nuxeo.ecm.platform.queue.core.DocumentQueueAdapterFactory" />
  </extension>
  
    <extension
    target="org.nuxeo.ecm.platform.scheduler.core.service.SchedulerRegistryService"
    point="schedule">
    <schedule id="queue-reaper-schedule">
          <username>system</username>
          <password></password>
          <eventId>queue-reaper-schedule</eventId>
          <eventCategory>default</eventCategory>
          <cronExpression>0 0/5 * * * ?</cronExpression>
     </schedule>
  </extension>

  <extension target="org.nuxeo.ecm.core.event.EventServiceComponent" point="listener">
    <listener name="queue-reaper" class="org.nuxeo.ecm.platform.queue.core.DocumentQueueReaper">
        <event>queue-reaper-schedule</event>
    </listener>
  </extension>

</component>